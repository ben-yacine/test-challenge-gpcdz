'use strict';

var sequelize   = require('sequelize');
var mongoose    = require('mongoose');
var db_access_mysql = require('./mysql/db_mysql_access.json');
var access_mongo = require('./mongo/db_mongo_access.json');

var cert = {
  key: '/etc/apache2/smartly.key',
  cer: '/etc/apache2/smartly.cer',
  chain: '/etc/apache2/smartly.txt'
}

var mongo_uri = "mongodb://"+access_mongo.DB_USER+":"+access_mongo.DB_PASSWORD+"@"+access_mongo.DB_HOST+"/"+access_mongo.DB_NAME;

mongoose.connect(mongo_uri, function(err) {
    if (err) throw err;
});

var sequelize = new sequelize(db_access_mysql.DB_NAME, db_access_mysql.DB_USER, db_access_mysql.DB_PASSWORD, {
  host: db_access_mysql.DB_HOST,
  dialect: 'mysql'
});

sequelize
  .authenticate()
  .then(function(err) {
    console.log('[MYSQL] Connection has been established successfully.');
  })
  .catch(function (err) {
    console.log('[MYSQL] Unable to connect to the database:', err);
  });

module.exports = {
	sequelize: sequelize,
	mongoose: mongoose,
  cert: cert
};
